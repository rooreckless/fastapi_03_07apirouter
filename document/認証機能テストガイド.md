# 認証機能テストガイド

このプロジェクトにはログイン認証機能が実装されています。以下の手順でテストできます。

## 実装済み機能

1. **ユーザー登録** - `/users/register`
2. **ログイン（トークン取得）** - `/auth/token`
3. **認証が必要なエンドポイント** - `/users/me`

## APIテスト手順

### 1. アプリケーションの起動

```bash
cd fastapi
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

### 2. ユーザー登録

```bash
curl -X POST "http://localhost:8000/users/register" \
  -H "Content-Type: application/json" \
  -d '{
    "username": "testuser",
    "password": "testpassword"
  }'
```

### 3. ログイン（アクセストークン取得）

```bash
curl -X POST "http://localhost:8000/auth/token" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "username=testuser&password=testpassword"
```

レスポンス例：
```json
{
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "token_type": "bearer"
}
```

### 4. 認証が必要なエンドポイントのテスト

取得したアクセストークンを使用：

```bash
curl -X GET "http://localhost:8000/users/me" \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN_HERE"
```

## Swagger UIでのテスト

ブラウザで `http://localhost:8000/docs` にアクセスすると、Swagger UIでAPIをテストできます。

1. `/users/register` でユーザーを登録
2. `/auth/token` でログイン
3. 右上の「Authorize」ボタンでトークンを設定
4. 認証が必要なエンドポイントをテスト

## セキュリティ設定

- JWTトークンの有効期限：30分
- パスワードハッシュ化：bcrypt
- トークンアルゴリズム：HS256

## 本番環境での注意点

`app/core/security.py` の `SECRET_KEY` は本番環境では環境変数に設定してください：

```python
SECRET_KEY = os.getenv("SECRET_KEY", "your-secret-key")
```
